# TIL_210804

## 👩‍💻오늘 한 일 / 배운 일

- 알고리즘 2문제
- 프로젝트 미팅
- lazy loading 학습 및 구현

## 😎 Good

- lazy loading 삽질

## 🤢 Bad

- lazy loading 삽질을 생각보다 너무 오래함..
- 다음부턴 새로운 기법 도입하기 전에 code sand box에서 테스트 하고 실제 코드에 적용시켜야겠다.

## 🏃‍♀️생각

- 전체 상품을 보여주는 페이지를 만들고 있는데, 상품 이미지 렌더링으로 인한 딜레이를 막기 위해 lazy loading 기법을 도입하였다.
- 사실 이 기능은 재사용 가능하게 만들어 놓기만 하면 다른 UI에도 적용할 수 있는 터라(리뷰 이미지 등) 재사용 가능한 방법을 고민하느라 너무 힘들었다.. 처음 생각했던 건 고차 컴포넌트를 만들어서 Lazy loading 기능을 하는 컴포넌트에 이미지 컴포넌트를 주입받아 lazy loading이 가능한 컴포넌트를 리턴하면 되지 않을까? 생각했는데.. 과연 될까? 싶었고, intersection observer를 만들고 적용시키는 건 함수에서 처리하고 처리된 결과(observe 중인 요소, 로딩된 img url)만 리턴해주는 방식도 괜찮을 것 같았다.. 그래서 custom hook으로 구현해보기로 결정했는데,
  무슨 이유에서인지 이상하게 적용돼서 오랜 시간 삽질을 했다.. (정해진 비율만 큼 view point가 도달하지 않았는데 모든 이미지가 로딩됨, 스크롤을 끝까지 내려야 이미지가 로딩됨 등등..ㅠㅠ)..흑흑..그만..
- 내일 다시 한번 살펴봐야겠다.. 근데 HOC로 하는 법은 없을까?? 생각해 보자..!
- 어찌어찌해서 구현은 했는데, 이 기법이 과연 최적화에 진짜 도움이 될까?라는 생각이 들었다.. 무한 스크롤로 엄청나게 많은 이미지를 불러오는 것도 아니고, 한 페이지에 들어갈 상품도 생각보다 많지 않기 때문이다. 컬리나 다른 이커머스 서비스를 살펴보니 lazy loading으로 구현된 페이지가 얼마 없어 보였다. 내가 알아채지 못한 걸까 .. 흠 .. 그래서 퍼포먼스 측정을 해봤는데 적용 후가 1점 더 높았고, largest Contentful Paint 부분도 0.1s 빨라졌다.. 근데 딱히.. 모르겠다. API 붙이면 차이가 더 나려나?
- 어쨌든 lazy load 한다는 것 자체가 유저한테 로딩 중인 상황을 노출한다는 건데 그걸 노출할 만큼 lazy load가 퍼포먼스 향상에 도움이 되는지는 지켜봐야 할 것 같다.
